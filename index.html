<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <style>
        body {
            margin: 0;
            padding: 0;
            border: 0;
            background-color: rgb(0, 50, 71);
            overflow-x: hidden;

        }

        .col-left {

        }

        .carousel-indicators {
            position: static !important;
        }
    </style>

</head>

<body>
    <div class="container-fluid">
        <div class="row position-relative">
            <img src="https://www.esa.int/var/esa/storage/images/esa_multimedia/images/2021/02/esa_webb_logo/23168175-2-eng-GB/ESA_Webb_logo_pillars.png"
                alt="esa logo" width="150" height="130" style="width: 160px; height: 130px;"
                class="position-absolute top-0 start-0" />
            <img src="https://copernicus-masters.com/wp-content/uploads/2020/03/Logo_ESA_solid-white.png" alt="esa logo"
                width="205" height="80" style="width: 205px; height: 80px;" class="position-absolute top-0 end-0" />
        </div>
        <div class="d-flex px-3 mt-5">
            <div class="col-12 col-lg-3 my-auto d-none d-lg-block">

                <div id="carouselExampleIndicators" class="carousel slide p-2 rounded"
                    data-bs-ride="carousel" data-bs-interval="false">

                    <div class="col-left carousel-inner">
                        <div class="carousel-item active">
                            <iframe class="d-block w-100 mx-auto" style="height: 300px;"
                                src="https://www.youtube.com/embed/6VqG3Jazrfs" title="YouTube video player"
                                frameborder="0"
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                allowfullscreen></iframe>
                        </div>
                        <div class="carousel-item">
                            <iframe class="d-block w-100 mx-auto" style="height: 300px;"
                                src="https://www.youtube.com/embed/6VqG3Jazrfs" title="YouTube video player"
                                frameborder="0"
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                allowfullscreen></iframe>
                        </div>
                        <div class="carousel-item">
                            <iframe class="d-block w-100 mx-auto" style="height: 300px;"
                                src="https://www.youtube.com/embed/6VqG3Jazrfs" title="YouTube video player"
                                frameborder="0"
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                allowfullscreen></iframe>
                        </div>
                    </div>
                    <div class="carousel-indicators mt-5">
                        <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0"
                            class="active " aria-current="true" aria-label="Slide 1"></button>
                        <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1"
                            aria-label="Slide 2"></button>
                        <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2"
                            aria-label="Slide 3"></button>
                    </div>
                </div>

            </div>
            <canvas id="scene1" class="col-12 col-md-6 d-block">

            </canvas>
            <div class="col-12 col-lg-3 my-auto d-none d-lg-block">
                <div id="carouselright" class="carousel slide p-2 rounded"
                    data-bs-ride="carousel" data-bs-interval="false">

                    <div class="col-left carousel-inner">
                        <div class="carousel-item active">
                            <iframe class="d-block w-100 mx-auto" style="height: 300px;"
                                src="https://www.youtube.com/embed/tnbSIbsF4t4" title="YouTube video player"
                                frameborder="0"
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                allowfullscreen></iframe>
                        </div>
                        <div class="carousel-item">
                            <iframe class="d-block w-100 mx-auto" style="height: 300px;"
                                src="https://www.youtube.com/embed/tnbSIbsF4t4" title="YouTube video player"
                                frameborder="0"
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                allowfullscreen></iframe>
                        </div>
                        <div class="carousel-item">
                            <iframe class="d-block w-100 mx-auto" style="height: 300px;"
                                src="https://www.youtube.com/embed/tnbSIbsF4t4" title="YouTube video player"
                                frameborder="0"
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                allowfullscreen></iframe>
                        </div>
                    </div>
                    <div class="carousel-indicators mt-5">
                        <button type="button" data-bs-target="#carouselright" data-bs-slide-to="0"
                            class="active" aria-current="true" aria-label="Slide 1"></button>
                        <button type="button" data-bs-target="#carouselright" data-bs-slide-to="1"
                            aria-label="Slide 2"></button>
                        <button type="button" data-bs-target="#carouselright" data-bs-slide-to="2"
                            aria-label="Slide 3"></button>
                    </div>
                </div>
            </div>
        </div>

        <canvas id="scene2">

        </canvas>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r126/three.min.js"
        integrity="sha512-n8IpKWzDnBOcBhRlHirMZOUvEq2bLRMuJGjuVqbzUJwtTsgwOgK5aS0c1JA647XWYfqvXve8k3PtZdzpipFjgg=="
        crossorigin="anonymous"></script>
    <script src="https://unpkg.com/three@0.126.0/examples/js/loaders/GLTFLoader.js"></script>
    <script type="module">
        import * as THREE from "./three.module.js";
        import { GLTFLoader } from "./GLTFLoader.js";
        import imgUrl from './img/globe.jpeg';
        import vertexShader from './shaders/vertex.glsl';
        import fragmentShader from './shaders/fragment.glsl';
        import atmosphereVertexShader from './shaders/atmosphereVertex.glsl';
        import atmosphereFragmentShader from './shaders/atmosphereFragment.glsl';

        const scene = new THREE.Scene()
        scene.background = new THREE.Color("rgb(0, 50, 71)");

        const scene2 = new THREE.Scene()
        scene2.background = new THREE.Color("rgb(0, 50, 71)");

        const camera = new THREE.PerspectiveCamera(
            75,
            innerWidth / innerHeight,
            0.1,
            4000
        )

        function mdSize() {
            if (window.innerWidth < 768) {
                return 650;
            } else {
                if (window.innerWidth < 992) {
                    return 750;
                } else {
                    return window.innerWidth * 0.48;
                }
            }

        }

        const renderer = new THREE.WebGLRenderer({
            antialias: true,
            canvas: document.getElementById('scene2')
        })
        renderer.setSize(innerWidth, innerHeight)
        renderer.setPixelRatio(window.devicePixelRatio)

        const renderer1 = new THREE.WebGLRenderer({
            antialias: true,
            canvas: document.getElementById('scene1')
        })
        renderer1.setSize(mdSize(), mdSize())
        console.log(window.innerWidth + " " + window.innerHeight)
        renderer1.setPixelRatio(window.devicePixelRatio)

        const sphere = new THREE.Mesh(new THREE.SphereGeometry(3, 50, 50),
            new THREE.ShaderMaterial({
                vertexShader,
                fragmentShader,
                uniforms: {
                    globeTexture: {
                        value: new THREE.TextureLoader().load(imgUrl)
                    }
                }

            })
        )
        scene.add(sphere)
        sphere.position.x = -8

        const atmosphere = new THREE.Mesh(new THREE.SphereGeometry(3, 50, 50),
            new THREE.ShaderMaterial({
                vertexShader: atmosphereVertexShader,
                fragmentShader: atmosphereFragmentShader,
                blending: THREE.AdditiveBlending,
                side: THREE.BackSide
            })
        )
        atmosphere.scale.set(1.2, 1.2, 1.2)
        atmosphere.position.x = -8
        //scene.add(atmosphere)

        const starGeometry = new THREE.BufferGeometry()
        const starMaterial = new THREE.PointsMaterial({
            color: 0xffffff
        })
        const starVertices = []
        for (let i = 0; i < 1000; i++) {
            const x = (Math.random() - 0.5) * 3000
            const y = (Math.random() - 0.5) * 3000
            const z = -Math.random() * 1000
            starVertices.push(x, y, z)
        }
        starGeometry.setAttribute('position', new THREE.Float32BufferAttribute(starVertices, 3))
        const stars = new THREE.Points(
            starGeometry, starMaterial
        )
        scene.add(stars)

        function mdY() {
            if (window.innerWidth < 768) {
                return -2000;
            } else {
                if (window.innerWidth < 992) {
                    return -1700;
                } else {
                    return -1450;
                }
            }
        }

        var loader = new GLTFLoader();
        var obj;
        loader.load("scene.gltf", function (gltf) {
            obj = gltf.scene;
            obj.position.set(0, 0, mdY());
            obj.rotation.y = 2;
            scene2.add(gltf.scene);
        });
        var light = new THREE.HemisphereLight(0xffffff, 0x000000, 3);
        scene2.add(light);
        camera.position.set(0, 0, 15);

        window.addEventListener('resize', resizeEvent);

        function resizeEvent() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix()
            obj.position.set(0, 0, mdY());
            renderer1.setSize(mdSize(), mdSize());
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer1.render(scene2, camera);
            renderer.render(scene, camera);
        }

        function animate() {
            requestAnimationFrame(animate)
            // manual clear
            renderer1.clear();
            renderer1.render(scene2, camera);
            renderer.clear();
            renderer.render(scene, camera);
            sphere.rotation.y += 0.001;
            obj.rotation.y += 0.003;
            // obj.rotation.x += 0;

        }
        animate()

    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
</body>

</html>